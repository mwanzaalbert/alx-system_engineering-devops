#!/usr/bin/env bash
# This script installs and configures Nginx to listen on port 80.

# Update package list and install Nginx
sudo apt-get update -y
sudo apt-get install -y nginx

# Ensure Nginx is configured to listen on port 80
NGINX_CONF="/etc/nginx/sites-available/default"
if ! grep -q "listen 80" "$NGINX_CONF"; then
  sudo sed -i 's/listen [0-9]* default_server;/listen 80 default_server;/g' "$NGINX_CONF"
  sudo sed -i 's/listen \[::\]:[0-9]* default_server;/listen [::]:80 default_server;/g' "$NGINX_CONF"
fi

# Create a simple HTML file to serve
echo '<html>
  <head><title>Welcome to Nginx</title></head>
  <body><h1>Success! The Nginx web server is installed and working.</h1></body>
</html>' | sudo tee /var/www/html/index.nginx-debian.html

# Start Nginx service
sudo service nginx start

# Restart Nginx to apply changes
sudo service nginx restart
